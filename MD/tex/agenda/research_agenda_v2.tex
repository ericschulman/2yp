\documentclass{article}

%math stuff
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{mathtools}

%bibliography/appendix
\usepackage{cite}
\usepackage[toc,page]{appendix}

%figures
\usepackage{graphicx}
\usepackage{booktabs}

%General Formating
\renewcommand*\familydefault{\sfdefault}
\usepackage[letterpaper, portrait, margin=1.5in]{geometry}
\usepackage{fancyhdr}
\pagestyle{fancy}

%Header
\lhead{Schulman}
\rhead{Page \thepage}

\title{Modeling Consumer Response to EDP Changes}
\author{Eric Schulman}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}

The objective of this research project is predicting the consumer reaction to changes in every day prices (EDP). Predicting how consumers will respond to EDP changes can help firms adjust their everyday prices to maximize sales volume and revenue before and after running promotions. The point of this project is to utilize multiple approaches to get as full a picture of consumer behavior as possible. In particular, this study involves two approaches. The first involves a traditional econometric model. This leverages well understood statistical techniques to describe the relationship between EDP and consumer behavior. However, it does not identify causal relationships between the EDP and consumer behavior. The second is a dynamic program, a recursive maximization problem that models consumer purchasing decisions. The dynamic program better isolates the causal relationship between consumer behavior and EDP changes, however the results are influenced by the assumptions of the model.

\subsection{Relevant Literature}

Manufacturers run trade promotions because they expect consumers to buy more when prices are low. The way consumers perceive past and current prices are what make promotions effective. As a result, research into trade promotions asks about how past prices relate to current purchasing decisions.  This project examines two mechanisms from the literature that describe how consumers consider past prices when making purchasing decisions.

In the first way, consumer use past prices as references when deciding whether or not to buy products during the promotion. Consumers use the difference between past prices as a heuristic for when to purchase. Putler's 1991 paper works out theoretical treatment of this mechanism \cite{putler}. More importantly, including the of effects of using past prices as references lends itself well to an econometric model. The most cited paper including reference price effects is Winer's econometric model from 1986. His model predicts the probability purchasing from a brand as a function of previous quantity sold, consumers price expectations, competitors' price and advertising spending.  \cite{winer}. Krishnamurthi and Raj's econometric model improves on Winer's model by separating the consumers decisions into two separate, and simultaneous economic decisions. Consumers simultameously decide which  brand to purchase and the quantity of the brand to buy  \cite{krishnamurthi}.

In the second mechanism, consumers use past prices to form expectations about future prices. When consumers go to the supermarket, they devise a plan for future purchases based on their expectations for prices in the future. Under this mechanism, the consumer buys more when prices are low because they intend to buy less in the future because they expect prices to go up. An econometric model is poorly suited to capture the effect these expectations because of the intertwined nature of future and present prices and purchases. The recursive framework of a dynamic programming models better captures the way past affects the present. Ahn, Gumus and Kaminsky developed a model consumers will wait until a future period for the price to fall to save money \cite{ahn}  Their model focuses on manufacturers decisions in the face of demand carrying over between periods. More importantly, Gonul and Srinivasan specified a model focused on consumer decisions to wait for prices to fall. In their model, consumers make purchasing decisions by forming expectations about future prices \cite{gonul}. They estimate the parameters in their model by iterating between solving their model and estimating the parameters using maximum likelihood estimation.

\section{Econometric Model}

The first approach to understanding consumer responses to EDP involves quantifying the statistical relationship between EDP and volume using a traditional econometric model. The statistical properties econometric models are well established. Even though econometric models poorly identify causality, understanding the correlation between product characteristics and volume can be informative.

\subsection{Winer's Model}

Winer's 1986 paper inspired the model used in this project. Krishnamurthi and Raj's econometric model is more nuanced because it breaks consumer decisions about brand and purchase quantity into separate econometric equations. Like Winer, their model relies on point of sales data. However, the syndicated data does not lend its self to their approach. 

On the other hand, Winer's model can be adapted to the syndicated data. Winer estimates the probability of buying a brands' product as a function of previous quantity sold, consumer price expectations, competitors' prices and advertising spending. Formally, Winer's model describes the probability of purchasing brand $i$ at time $t$. It takes into account past volumes, consumer price expectations, competitors price and advertising spending. It is given by the equation below followed by descriptions of the variables \cite{winer}. \\

$ {Pr(BRAND_i)}_{it} = \alpha_0 + \alpha_1 {VOL}_{it} + \alpha_2 {ADV}_{it} + \medskip  \alpha_3 PRICE\_REACT_{it}  + \alpha_4 \dfrac{PRICE_it}{TOTAL\_PRICE_{t}} + \epsilon_{it}$\\


$${Pr(BRAND_i)}_{it} $$

Winer's model is a logistic regression. The dependent variable is a boolean variable representing whether or not the brand was purchased at time $t$ before fitting. The data comes from the point of sale, so when the consumer makes a purchase, the consumer implicitly did not buy the other brands were not purchased. In other words, if there are $j$ brands then there $j-1$ more data points are generated for all the brands that were not purchased. 

$$VOL_{it}$$ 

The above variable represents the volume at of brand $i$ at time $t$. Its coefficient represents the relationship between volume and purchase probability.

$$ADV_{it}$$ 

The above variable is a boolean based on the advertising spending of brand $i$ at time $t$. It is an aggregate metric that takes into account various types of promotional spending.

$$PRICE\_REACT_{it}$$ 

The above variable is meant to capture a reaction in the reference price. It is calculated as

 $$\dfrac{PRICE_{it}} {\sum_j PRICE_{jt}} - \widehat{PRICE}_{it}$$ 

In the formula, ${PRICE}_{it}$ is the price charged by brand $i$ at time $t$. $\widehat{PRICE}_{it}$ represents the consumers expectation for the price at the current time period period. It involves estimating ${PRICE}_{it}$ as a function of ${PRICE}_{it-1}$. This process is called two stage least squares. In two stage least squares, we look at the effect of one variable 'through' another variable.  In this case we are looking on how past prices effect the current price 'through' the current price. We do this by running running a regression using a variable called an instrument (in this case, previous price) on another variable (in this case price). We use the predicted values from the first regression in a second regression. This project uses this technique as well when estimating the model.

$$ \dfrac{PRICE_{it}}{TOTAL\_PRICE_{t}}$$ 

The above variable represents the ratio between the price of brand $i$ at time $t$ against its competitors to capture the over all pricing environment.

\subsection{Model Description}

The main model in this project emulates Winer's model with several modifications to suit our data set. In order to take advantage of syndicated data, the model predicts percentage changes in the volume sold by group $i$ in consumer trade area (CTA) $j$ at time $t$. Instead of advertising expenditures we include group characteristic boolean variables to proxy for fixed effects caused by each groups marketing departments. The estimated equations for this model along with selected other models are included in the appendix section.\\ 

$ log(VOL_{ijt}) = \alpha_0 + \alpha_0 {PRICE}_{ijt} + \alpha_0 EDP_{ijt} + \sum_{k=3}^{11} \alpha_k {GROUP}_{ijt}  \medskip + \alpha_{12} {PRICE}_{ijt-1} + \alpha_{13} {PRICE}_{ijt-2}  \medskip + \alpha_{14}{VOL\_RATIO}_t  + \alpha_{15} {PRICE\_RATIO}_{t} + \alpha_{16} {VOL}_{ijt-1} + \alpha_{17} {VOL}_{ijt-2}  + \epsilon_{ijt}   $\\

\subsection{Description of the Variables}

$$\log( VOL_{ijt} )$$ 

The above variable can be interpreted as percentage changes in volume. We also looked at linear volume ($VOL_{ijt}$) as a dependent variable. Previous volume is overwhelmingly the most statistically important factor involved with predicting future volumes. This is the main reason for looking at percentage changes in volume. Additionally, looking at the logarithm of volume makes interpreting results easier.

$${PRICE}_{ijt}, EDP_{ijt}$$ 

The variable ${PRICE}_{ijt}$ is the price for CTA $j$ for product group $i$ at time $t$. The coefficient on price can be interpreted as the expected percentage change in volume corresponding to a 1 dollar increase in price all else equal. The variable $EDP_{ijt}$ is the everyday price for CTA $j$ in Group $i$ at time $t$. The coefficient on $EDP_{ijt}$ can be interpreted as the expected percentage change in volume corresponding to a 1 dollar increase in EDP all else equal.

$$ \sum_{k=3}^{11} \alpha_k {GROUP}_{ijt} $$ 

The above variables are boolean variables describing the group characteristics. Their coefficients represent the fixed effects of these variables. The characteristics are whether or not the creamer was flavored, dairy-free, and which of the five brands it belonged too.  The coefficient on these variables can be interpreted as the fixed effects of brand on volume changes. Finally, there are variables that represent the size of the product.

$${PRICE}_{ijt-1}, {PRICE}_{ijt-2} $$

The coefficient on the above variables represents the magnitude of a one dollar increase of price for group $j$ in CTA $i$ at week $t-1$ and $t-2$ respectively would be expected to effect percentage changes in volume at week $t$. After experimenting with various models, we chose to include the previous price going back two weeks.

$${VOL\_RATIO}_t, {PRICE\_RATIO}_{t} $$ 

The above variable $ {VOL\_RATIO}_t $ represents the volume of group $i$ in CTA $j$ as fraction of total volume. We include it because it represents brand penetration.  ${PRICE\_RATIO}_{t} $ represents price as a ratio of average price across all of the CTA groups. The coefficient represents how increasing the ratio is expected to change percentage change in volume between price and volume. We included the term ${PRICE\_RATIO}_{t}$  specifically because Winer includes a similar term in his model to represent the contribution of competitors price.

$${VOL}_{ijt-1}, {VOL}_{ijt-2} $$

The above variables represent volume of the previous two weeks. The coefficients represent how changing volume from previous weeks is expected to change percentage changes in volume.

$$ CTA_i, WEEK_{i}$$

We estimated additional models involving boolean variables. The first model includes boolean variables that represent each of the thirty CTAs. In the model with CTA, ${PRICE\_RATIO}_{t}$ and ${PRICE\_RATIO}_{t}$ must be adjusted to reflect average price and volume within the CTA.

$$\widehat{PRICE}_{ijt}$$

Like Winer, we used previous prices to do two stage least squares. This process involves estimating ${PRICE}_{ijt}$ as a function of ${PRICE}_{ijt-1}$ to create $\widehat{PRICE}_{ijt}$. Two stage least squares looks at the effect of one variable 'through' another variable.  In this case we are looking on how past prices effect the current price 'through' the current price. 

Using this process assumes that the past prices only relate to future volume changes 'through' consumers the current price. This assumption makes sense through the lenses of the reference price literature. In the literature, past prices effect current purchasing decisions because their relationship to current prices. Papers often invoke an explicit assumption that previous prices only affect purchasing decisions through the reference price \cite{putler}.

\section{Dynamic Program}

The second approach to predicting consumer reactions to EDP involves using a dynamic program to model how consumers chose quantities of goods to buy. The problem involves minimizing the cost faced by consumers over multiple periods. The consumer considers past purchases, and expectations for future prices to simultaneously decide on a quantity to purchase and a plan for future purchases. The model parameters are estimated by iterating between solving the consumer's problem and a maximum likelihood estimation routine. Although the statistical properties of this approach are not as documented, changes in consumer behavior within the model can be better attributed to EDP changes.

\section{Gonul and Srinivasan's Model}

This project emulates Gonul and Srinivasan's approach to predicting consumer behavior\cite{gonul}. Similar to Winer, Gonul and Srinivasan use point of sale data which tells them which brand each household purchased. The data also implicitly tells them brands that were not purchased. 

To predict consumer choice, Gonul and Srinivasan estimate the costs associated with making a purchase or waiting for a promotion. The saving from future promotions factor into the costs of buying or waiting. In other words, consumers anticipate future promotions and make purchases accordingly. Gonul and Srinvasan use a recursive cost function $C(B_t)$ to calculate costs. The argument to the cost function, $B_t$ is boolean variable representing whether the brand was purchased. Consumers minimize costs, which are discounted by $\delta$, over each period.

$$\text{Minimize } E( \sum_t \delta^{t} C(B_t) + \epsilon_{it} )$$

Gonul and Srinivasan's use maximum likelihood estimation to estimate the parameters of $C(B_t)$. They specify a likelihood function in terms of $C(B_t)$. Maximum likelihood estimation maximizes the likelihood function's probability, so parameters in $C(B_t)$ maximize the probability of the observed purchases. In order to build the likelihood function, Gonul and Sriviansan estimate the probability of making purchase. Below they calculate  $Pr(B_t=1)$ and specify the likelihood function. They assume there is a stochastic component $\epsilon_{it}$ to the costs. In the calculation, $\Phi$ is the cumulative distribution function for the standard normal distribution. 

$$Pr(B_t=1) = Pr(C(B_t = 1) + \epsilon_{1t} < C(B_t = 0) + \epsilon_{0t} )$$ 

$$=  Pr(  \epsilon_{0t} + \epsilon_{1t} < C(B_t = 0) - C(B_t = 1) )  = \Phi(C(B_t = 0) - C(B_t = 1) ) ) $$

They combine these probabilities in the likelihood function below. Gonul and Srinivasan initialized values for parameters in cost function and then iterated between the likelihood function and the dynamic program until the parameters in the cost function converged. The likelihood function is given below.

$$\text{Maximize} \prod_{t} Pr({B_t= 1})^{B_t} Pr(B_t=0)^{1-B_t} $$

\subsection{Model Specification}

The model in this paper modifies Gonul and Srinivasan's model to use syndicated data. Instead of modeling purchases as a binary decision, purchases are based on volumes. Consumers have a target consumption of $\bar{x}$ in the cost function. They incur a penalty for consuming more or less. Having a consumption target allows the consumer to deviate from this target based on prices and purchase more during promotions and less afterwards, as expected. The consumer's cost function is given as:

$$ C(x_0) = \alpha_1 (x_1 +x_0 - \bar{x})^2 + p_1 x_1 $$

Like in Gonul and Srinivasan's model, the consumer makes purchases by trying to minimize the future costs associated with that purchase. When calculating these costs, the consumer must consider their future costs based on their current stockpiles, prices, and their expectations for future prices. To calculate future costs, the consumer implicitly forms a plan for future purchases.  This leads to the recursive formulation below. Consumers try to minimize costs, which are discounted by $\delta$ in each period.

$$ \text{Minimize }_{x} \sum_t \delta^t (x_t + x_{t-1} - \bar{x})^2 + p x $$

The two key take aways of the dynamic program are (1) Consumers minimize costs over future periods. They can carry over goods from period to period, so they can 'stock up' on goods during promotions. (2) Consumers do not know future prices. If consumers knew the future prices, then they would know their future costs with certainty. They would always follow the optimal purchase plan. Because they do not know prices, consumers must adapt their purchases to unexpected promotions. Of course, The way consumers expectations will influence the model's results.

\section{Preliminary Regression Results}

At this stage, we have estimated various versions of the econometric model. The coefficient on EDP is persistently positive through all of the estimated models. Perhaps a higher EDP makes promotions more effective by signaling a brand's quality. Consumers may feel that they get a better value when the price starts out high. We estimated a model without EDP as an explanatory variable. Removing this variable causes the coefficients on group characteristics to slightly increase in magnitude. This supports the theory that EDP carries some information about the quality of the product. If EDP contained information about the product quality, the group characteristics would exhibit upward bias without it, increasing the value of the group coefficients. Removing EDP also causes the coefficient on price to decrease in magnitude.

In all versions of the model, past volume explains most of the variance in future volumes. As we can see in the appendix, using just price, and the previous two weeks of volume explains 88 percent of the variance in volumes. This is not very informative about what firms can do to increase volumes. Estimating a log linear model (i.e. $log(VOL)$) reveals more about the relationship between the other characteristics and volume. This variable can be interpreted as percentage change in volume. It helps distinguish how price and product characteristics contribute to volume changes. 

Finally, the mechanism proposed in the literature regarding reference prices may be correct. Previous prices may only be correlated with purchase 'through' their relationship with present prices. Depending on the model, previous prices may not be statistically significant at the five percent level. Running the two stage regression causes the coefficient on price to fall and the p-values on the product characteristics to increase.

\section{Conclusion}

This project utilizes multiple approaches for a full picture of consumer behavior in response to EDP changes. The econometric model describes the relationship between various factors and volumes using established statistical techniques. It builds on the intuition that consumers use prices decreases as a psychological heuristic for making purchases. It also builds on the large literature of econometric models trying to predict how price changes affect sales outcomes.  Counter-intuitively, EDP is consistently correlated with a positive increase in volume. A higher EDP may make promotions more effective. Additionally, past volumes are the most important statistical factor in explaining future volumes.

The dynamic programming model is a more involved approach toward predicting consumer behavior.  The dynamic program establishes more causality between EDP changes and consumer behavior than the econometric model. It captures the intuition that consumers buy more because they expect future prices to increase the next time they visit the store. However, the dynamic program makes more assumptions and uses less established techniques to make predictions. The next steps for involve estimating the dynamic programming model and extending it to include multiple brands. Additionally, exploring other mathematical tools like high dimensional model representation can aid this project. 

\pagebreak

\bibliography{bibliography}{}
\bibliographystyle{plain}

\pagebreak

\begin{appendices}

\section{Past Volumes Regression Results}
\input{tables/just_vol}

\pagebreak

\section{Volumes Regression Results}
\input{tables/linear_vol}

\pagebreak

\section{Log(VOL) Regression Results}
\input{tables/log_vol}

\pagebreak

\section{No EDP Regression Results}
\input{tables/log_vol_no_EDP}

\pagebreak

\section{2 Stage Least Squares Regression Results}

\subsection{Stage 1}
\input{tables/1SLS}

\pagebreak

\subsection{Stage 2}
\input{tables/2SLS}

\pagebreak

\section{CTA Boolean Variables Regression Results}
\input{tables/CTA_boolean}


\end{appendices}

\end{document}

